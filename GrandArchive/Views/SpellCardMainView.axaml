<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:GrandArchive.ViewModels"
             xmlns:views="clr-namespace:GrandArchive.Views"
             xmlns:database="clr-namespace:GrandArchive.Models.Database"
             mc:Ignorable="d"
             x:Class="GrandArchive.Views.SpellCardMainView"
             x:DataType="viewModels:SpellCardMainViewModel"
             Loaded="OnLoaded">
    <Design.DataContext>
        <viewModels:SpellCardMainViewModel/>
    </Design.DataContext>
    
    <Grid RowDefinitions="Auto *">
        <Menu Grid.Row="0">
            <MenuItem Header="Load Spells" Command="{Binding LoadSpellsCommand}"/>
            <MenuItem Header="Save Spells" Command="{Binding SaveSpellsCommand}"/>
            <MenuItem Header="Export Selected Spell Card" Click="ExportSelectedSpellCard"/>
            <MenuItem Header="Export All Spell Cards" Click="ExportAllSpellCards"/>
        </Menu>
        
        <Grid Grid.Row="1" ColumnDefinitions="Auto *">
            <Grid Grid.Column="0" RowDefinitions="Auto * Auto" RowSpacing="5"
                  DataContext="{Binding #SpellDataGrid.((database:DndSpell)SelectedItem)}">
                <Viewbox Grid.Row="0" Stretch="Uniform" Height="400" Width="600">
                    <views:SpellCardRenderView/>
                </Viewbox>

                <ScrollViewer Grid.Row="1">
                    <!-- ReSharper disable Xaml.PossibleNullReferenceException -->
                    <views:SpellCardEditView VerticalAlignment="Top" MaxWidth="600" Margin="5"
                                             DndRuleBooks="{Binding $parent[views:SpellCardMainView].((viewModels:SpellCardMainViewModel)DataContext).RuleBooks}"
                                             DndClasses="{Binding $parent[views:SpellCardMainView].((viewModels:SpellCardMainViewModel)DataContext).Classes}" />
                    <!-- ReSharper restore Xaml.PossibleNullReferenceException -->
                </ScrollViewer>
                
                <ToggleButton Grid.Row="2" Content="Spell Verified" IsChecked="{Binding IsVerified}"
                              HorizontalAlignment="Stretch" FontSize="20"/>
            </Grid>
            
            <DataGrid Grid.Column="1" ItemsSource="{Binding Spells}" IsReadOnly="True"
                      x:Name="SpellDataGrid" AutoGenerateColumns="False" SelectedIndex="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Id" Binding="{Binding Id}"/>
                    <DataGridCheckBoxColumn Header="Verified" Binding="{Binding IsVerified}"/>
                    <DataGridTextColumn Header="Name" Binding="{Binding Name}"/>
                    <DataGridTextColumn Header="Class Levels" Binding="{Binding ClassDisplayTextMultiLine}"/>
                    <DataGridTextColumn Header="Schools" Binding="{Binding School}"/>
                    <DataGridTextColumn Header="Subschools" Binding="{Binding SubSchool}"/>
                    <DataGridTextColumn Header="Descriptor" Binding="{Binding Descriptor}"/>
                    <DataGridTextColumn Header="Source" Binding="{Binding Rulebook.Name}"/>
                    <DataGridTextColumn Header="Page" Binding="{Binding RulebookPage}"/>
                    <DataGridTextColumn Header="Casting Time" Binding="{Binding CastingTime}"/>
                    <DataGridTextColumn Header="Range" Binding="{Binding RangeDisplayText}"/>
                    <DataGridTextColumn Header="Target" Binding="{Binding Target}"/>
                    <DataGridTextColumn Header="Area" Binding="{Binding Area}"/>
                    <DataGridTextColumn Header="Effect" Binding="{Binding Effect}"/>
                    <DataGridTextColumn Header="Duration" Binding="{Binding Duration}"/>
                    <DataGridTextColumn Header="Saving Throw" Binding="{Binding SavingThrow}"/>
                    <DataGridTextColumn Header="Spell Resistance" Binding="{Binding SpellResistance}"/>
                    <DataGridTextColumn Header="Summary" Binding="{Binding DescriptionShort}"/>
                    <DataGridCheckBoxColumn Header="V" Binding="{Binding HasVerbalComponent}"/>
                    <DataGridCheckBoxColumn Header="S" Binding="{Binding HasSomaticComponent}"/>
                    <DataGridCheckBoxColumn Header="M" Binding="{Binding MaterialComponent}"/>
                    <DataGridCheckBoxColumn Header="AF" Binding="{Binding HasArcaneFocus}"/>
                    <DataGridCheckBoxColumn Header="DF" Binding="{Binding HasDivineFocus}"/>
                    <DataGridCheckBoxColumn Header="XP" Binding="{Binding HasExperienceComponent}"/>
                    <DataGridCheckBoxColumn Header="BR" Binding="{Binding HasBreathComponent}"/>
                    <DataGridCheckBoxColumn Header="TN" Binding="{Binding HasTruenameComponent}"/>
                    <DataGridCheckBoxColumn Header="CR" Binding="{Binding HasCorruptionComponent}"/>
                    <DataGridTextColumn Header="Material Components" Binding="{Binding MaterialComponent}"/>
                    <DataGridTextColumn Header="XP Cost" Binding="{Binding ExperienceComponent}"/>
                    <DataGridTextColumn Header="Corruption" Binding="{Binding CorruptionComponent}"/>
                    <DataGridTextColumn Header="Extra Components" Binding="{Binding ExtraComponent}"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</UserControl>
